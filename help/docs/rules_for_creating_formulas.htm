<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head>
   <title>Rules for Creating Formulas</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="formulas,creating formulas,formula rules,rules for formulas,spaces in field names" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <meta name="id" content="Rules_for_Creating_Formulas" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <style type="text/css">
a { color: #2766AD; text-decoration: underline; }
a:visited {color: #7DA3CE; }
a:hover {text-decoration: none; }
</style>
<script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if (location.search.lastIndexOf("toc=0")<=0) {
  if (parent.frames.length==0) { parent.location.href="index.html?rules_for_creating_formulas.htm"; }
  else { parent.quicksync('a11.2'); }
}
//-->
</script>
<script type="text/javascript" src="highlight.js"></script></head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;" onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>


<table width="100%" border="0" cellspacing="0" cellpadding="5" style="background-color: <%TOPIC_HEADER_BGCOLOR%; background-image: url(header_gradient.png); background-repeat: repeat-x;">
  <tr valign="middle">
    <td align="left">
      <p class="p_Heading1"><span class="f_Heading1">Rules for Creating Formulas</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="strata_welcome.htm"><img src="icon_home_16.gif" border=0 alt="Home" title="Home"></a>&nbsp;&nbsp;
     <a href="types_of_formulas.htm"><img src="icon_back_arrow_16.gif" border=0 alt="Back" title="Back"></a>&nbsp;&nbsp;
     <a href="using_the_formula_builder.htm"><img src="icon_forward_arrow_16.gif" border=0 alt="Next" title="Next"></a>&nbsp;&nbsp;
     </span>
    </td>
  </tr>
</table>

   
<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p style="font-size: 8pt; margin-bottom: 15px">
<a href="working_with_formulas.htm">Working with Formulas</a> &gt; Rules for Creating Formulas</p>
<p>&nbsp;</p>
<p>This page offers general rules for creating formulas and ways to determine whether a formula is valid:</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p class="p_Heading2"><span class="f_Heading2">Rules for Creating Formulas</span></p>
<p>&nbsp;</p>
<p>Expressions must follow a set of rules for the software to interpret them. To create a formula with correct syntax, the following rules apply:</p>
<p>&nbsp;</p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 48px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #444444;">&#8226;</span></td><td><span class="f_Bullets">The expression must be the correct type for the data operation for which it is used. If the data operation requires a logical condition, then the expression needs to produce a logical condition.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 48px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #444444;">&#8226;</span></td><td><span class="f_Bullets">All of the fields, functions and values used in the expression must have data types that can be used correctly together.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 48px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #444444;">&#8226;</span></td><td><span class="f_Bullets">All of the fields, functions and values used in the expression must be spelled and formatted correctly.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 48px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #444444;">&#8226;</span></td><td><span class="f_Bullets">All the functions used in the expression must have the correct set of parameters.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 48px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #444444;">&#8226;</span></td><td><span class="f_Bullets">Each open parenthesis, "(" used in the expression must have a corresponding close parenthesis, ")", and vice-versa.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 48px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #444444;">&#8226;</span></td><td><span class="f_Bullets">If the expression has multiple fields, functions or values, these expression elements must be combined correctly.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 48px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #444444;">&#8226;</span></td><td><span class="f_Bullets">All operators used in the expression must be positioned and employed correctly.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 48px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #444444;">&#8226;</span></td><td><span class="f_Bullets">All text values must be contained within a set of double quotation marks: " ".</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 48px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #444444;">&#8226;</span></td><td><span class="f_Bullets">All folder, table and field names that include spaces must be contained within a set of brackets: [ ] (see below).</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 48px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #444444;">&#8226;</span></td><td><span class="f_Bullets">The expression must not contain any mathematically impossible elements, such as division by zero.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 48px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #444444;">&#8226;</span></td><td><span class="f_Bullets">The expression must not contain any extraneous fields, functions, values, symbols or other elements.  </span></td></tr></table></div><p>&nbsp;</p>
<p>&nbsp;</p>
<p class="p_Heading2"><span class="f_Heading2">Valid and Invalid Expressions</span> </p>
<p>&nbsp;</p>
<p>When you create formula, it needs to be valid in order for the software to accept it. A valid formula is one that is syntactically correct, meaning that the identifiers, functions, operators and values in the expression are arranged as discussed in the above rules. </p>
<p>&nbsp;</p>
<p>The <a href="using_the_formula_builder.htm">formula builder</a> has a built-in tool that lets you know the validity of any given formula by showing either a green check mark for a valid formula or a red "X" for an invalid one. &nbsp;This formula checker automatically updates as you type.</p>
<p>&nbsp;</p>
<p class="p_Note"><span class="f_Note">NOTE: &nbsp;The formula validation indicator is disabled for <a href="create_direct_connections_to_d.htm">external data tables</a> so that native database expressions can be entered in the formula builder and run against the external database.</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p class="p_Heading2"><span class="f_Heading2">Handling Folder, Table and Field Names with Spaces</span></p>
<p>&nbsp;</p>
<p>In many situations, folder names, table names and field names do not contain spaces in them, such as "myfield" or "my_table" or "my_data_folder". &nbsp;These can be referenced in a formula or a query using the name or the name with brackets around it. &nbsp;For example the following two expression are both valid:</p>
<p>&nbsp;</p>
<p class="p_CodeExample2"><span class="f_CodeExample2">Field1&nbsp;*&nbsp;Field2</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">[Field1]&nbsp;*&nbsp;[Field2]</span></p>
<p>&nbsp;</p>
<p>At other times folders, tables or field names have spaces in them, such as "my field" or "my data folder". &nbsp;In order to reference these in a formula or query, the full name must be contained within brackets. &nbsp;For example, the following two expressions are valid:</p>
<p>&nbsp;</p>
<p class="p_CodeExample2"><span class="f_CodeExample2">[Field&nbsp;&nbsp;1]&nbsp;*&nbsp;[Field&nbsp;&nbsp;2]</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">Field1&nbsp;*&nbsp;[Field&nbsp;&nbsp;2]</span></p>
<p>&nbsp;</p>
<p>When field names and table names are used together, the same rules apply, but the table name and field name portion work independently so that brackets are only required for the name that includes spaces. &nbsp;Here are some valid examples:</p>
<p>&nbsp;</p>
<p class="p_CodeExample2"><span class="f_CodeExample2">Table1.Field1&nbsp;*&nbsp;Table2.Field2</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">Table1.[Field1]*[Table2].Field2</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">[Table1].[Field1]*Table2.[Field2]</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">Table1.[Field&nbsp;1]&nbsp;*&nbsp;Table2.[Field&nbsp;2]</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">[Table&nbsp;1].[Field&nbsp;1]*[Table&nbsp;2].Field2</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>

</td></tr></table>
  <!-- Turn off when compiling anything but browser-based help (for the web) -->      
 
     <!--   --> 

</body>
</html>
