<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head>
   <title>Importing Data Using Scripts</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="data,data importing,databases,db2,ebcdic,external databases,importing data,mysql,odbc,oracle,scripts,sql server" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <meta name="id" content="Importing_Data_Using_Scripts" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <style type="text/css">
a { color: #2766AD; text-decoration: underline; }
a:visited {color: #7DA3CE; }
a:hover {text-decoration: none; }
</style>
<script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if (location.search.lastIndexOf("toc=0")<=0) {
  if (parent.frames.length==0) { parent.location.href="index.html?importing_data_using_scripts.htm"; }
  else { parent.quicksync('a4.4.3'); }
}
//-->
</script>
<script type="text/javascript" src="highlight.js"></script></head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;" onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>


<table width="100%" border="0" cellspacing="0" cellpadding="5" style="background-color: <%TOPIC_HEADER_BGCOLOR%; background-image: url(header_gradient.png); background-repeat: repeat-x;">
  <tr valign="middle">
    <td align="left">
      <p class="p_Heading1"><span class="f_Heading1">Importing Data Using Scripts</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="strata_welcome.htm"><img src="icon_home_16.gif" border=0 alt="Home" title="Home"></a>&nbsp;&nbsp;
     <a href="exporting_data_sets.htm"><img src="icon_back_arrow_16.gif" border=0 alt="Back" title="Back"></a>&nbsp;&nbsp;
     <a href="viewing_data_sets.htm"><img src="icon_forward_arrow_16.gif" border=0 alt="Next" title="Next"></a>&nbsp;&nbsp;
     </span>
    </td>
  </tr>
</table>

   
<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p style="font-size: 8pt; margin-bottom: 15px">
<a href="opening_and_saving_data_files.htm">Accessing and Saving Data</a> &gt; <a href="importing_and_exporting_data.htm">Importing and Exporting Data</a> &gt; Importing Data Using Scripts</p>
<p>&nbsp;</p>
<p>At times, it can useful to create a script to transform and import an external data set instead of using the other options for <a href="opening_data.htm">opening</a>, <a href="create_direct_connections_to_d.htm">connecting to</a> or <a href="importing_data_sets.htm">importing</a> data. &nbsp;This section provides a very brief sample script and related notes to get you started with an import. &nbsp;Please see the <a href="using_scripts_and_extensions.htm">scripting section</a> for further information on using scripts.</p>
<p>&nbsp;</p>
<p>Below is a sample script that defines the fields of an external data set and then imports the table into Tabular IQ:</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p class="p_CodeExample2"><span class="f_CodeExample2">var&nbsp;def&nbsp;=</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">{</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">&nbsp;&nbsp;&nbsp;&nbsp;type:&nbsp;"fixed",</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">&nbsp;&nbsp;&nbsp;&nbsp;row_width:&nbsp;15,</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">&nbsp;</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">&nbsp;&nbsp;&nbsp;&nbsp;fields:</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">&nbsp;&nbsp;&nbsp;&nbsp;[</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{source_offset:&nbsp;&nbsp;0,&nbsp;source_width:&nbsp;&nbsp;2,&nbsp;name:&nbsp;"FIELD1",&nbsp;type:&nbsp;DbType.Character,&nbsp;width:&nbsp;&nbsp;2,&nbsp;scale:&nbsp;0&nbsp;},</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{source_offset:&nbsp;&nbsp;2,&nbsp;source_width:&nbsp;&nbsp;2,&nbsp;name:&nbsp;"FIELD2",&nbsp;type:&nbsp;DbType.Character,&nbsp;width:&nbsp;&nbsp;2,&nbsp;scale:&nbsp;0&nbsp;},</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{source_offset:&nbsp;&nbsp;4,&nbsp;source_width:&nbsp;&nbsp;4,&nbsp;name:&nbsp;"FIELD3",&nbsp;type:&nbsp;DbType.Character,&nbsp;width:&nbsp;&nbsp;4,&nbsp;scale:&nbsp;0&nbsp;},</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{source_offset:&nbsp;&nbsp;8,&nbsp;source_width:&nbsp;&nbsp;6,&nbsp;name:&nbsp;"FIELD4",&nbsp;type:&nbsp;DbType.Character,&nbsp;width:&nbsp;&nbsp;6,&nbsp;scale:&nbsp;0&nbsp;},</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{source_offset:&nbsp;14,&nbsp;source_width:&nbsp;&nbsp;1,&nbsp;name:&nbsp;"FIELD5",&nbsp;type:&nbsp;DbType.Character,&nbsp;width:&nbsp;&nbsp;1,&nbsp;scale:&nbsp;0&nbsp;},</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{source_offset:&nbsp;14,&nbsp;source_width:&nbsp;&nbsp;1,&nbsp;name:&nbsp;"FIELD6",&nbsp;type:&nbsp;DbType.Character,&nbsp;width:&nbsp;&nbsp;1,&nbsp;scale:&nbsp;0,&nbsp;formula:&nbsp;"UPPER(FIELD5)"&nbsp;}</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">&nbsp;&nbsp;&nbsp;&nbsp;]</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">};</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">&nbsp;</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">&nbsp;</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">//&nbsp;assign&nbsp;a&nbsp;layout&nbsp;to&nbsp;the&nbsp;file</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">HostServices.data.assignDefinition("c:\\users\\myname\\sample.txt",&nbsp;def);</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">&nbsp;</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">&nbsp;</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">//&nbsp;optionally&nbsp;import&nbsp;this&nbsp;file&nbsp;into&nbsp;a&nbsp;table&nbsp;called&nbsp;"tbl"</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">var&nbsp;db&nbsp;=&nbsp;HostApp.getDatabase();</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">db.execute("SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;tbl&nbsp;FROM&nbsp;file://c:/users/myname/sample.txt");</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">HostApp.refresh();</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">&nbsp;</span></p>
<p class="p_CodeExample2"><span class="f_CodeExample2">alert("done");</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>When creating your script, please note the following definitions:</p>
<p>&nbsp;</p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 48px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #444444;">&#8226;</span></td><td><span class="f_Bullets" style="font-weight: bold;">Source Offset:</span><span class="f_Bullets"> &nbsp;Each external data set is considered a string or byte stream; the source offset defines where each field begins. &nbsp;The source offset is zero-based, meaning that the first character is letter 0, the second 1, and so on.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 48px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #444444;">&#8226;</span></td><td><span class="f_Bullets" style="font-weight: bold;">Source Width:</span><span class="f_Bullets"> &nbsp;This defines the length of the input field.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 48px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #444444;">&#8226;</span></td><td><span class="f_Bullets" style="font-weight: bold;">Name:</span><span class="f_Bullets"> &nbsp;This is the field name you wish to create in the output table.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 48px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #444444;">&#8226;</span></td><td><span class="f_Bullets" style="font-weight: bold;">Type:</span><span class="f_Bullets"> This is formatted as DbType.____, where the blank can be Character, WideCharacter, Binary, Numeric, Double, Integer, Date, DateTime or Boolean. &nbsp;This refers to the type of the output field. &nbsp;The type of the input field is always considered a string or a byte stream.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 48px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #444444;">&#8226;</span></td><td><span class="f_Bullets" style="font-weight: bold;">Width/Scale:</span><span class="f_Bullets"> &nbsp;This defines the field width and decimal places (if applicable) for your output field. Source width and output width can be different, as it may be desirable to have an output width that is greater than the input width.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 48px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #444444;">&#8226;</span></td><td><span class="f_Bullets" style="font-weight: bold;">Formula:</span><span class="f_Bullets"> &nbsp;You can use database expressions to perform an optional type conversion. &nbsp;For example, if you had a date in the YYYYMMDD format in your data, you could write the formula: "DATE($SRCFIELD,'YYYYMMDD')", and then specify "type" as a DbType.Date. &nbsp;This would auto convert the type for you.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 48px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #444444;">&#8226;</span></td><td><span class="f_Bullets" style="font-weight: bold;">Source_Encoding:</span><span class="f_Bullets"> &nbsp;This is formatted as DbEncoding._____, where the blank can be filled with ASCII, EBCDIC, COMP, or COMP3 (if you require mainframe conversions). &nbsp;This is only necessary if you are transforming from a non-ASCII file and is added into each field definition line.</span></td></tr></table></div><p>&nbsp;</p>

</td></tr></table>
  <!-- Turn off when compiling anything but browser-based help (for the web) -->      
 
     <!--   --> 

</body>
</html>
